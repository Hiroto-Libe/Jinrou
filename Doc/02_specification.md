# 🐺 人狼Webアプリ 仕様検討まとめ

## 1. フェーズ構成

WAITING → ROLE_ASSIGN → NIGHT → DAWN_RESOLVE → MORNING
→ DAY → VOTE → TALLY → RUNOFF → EXECUTION
→ MEDIUM_REVEAL → WIN_CHECK → RESULT

- 遷移トリガは GM（ホスト）
- 内部自動処理：`DAWN_RESOLVE` / `WIN_CHECK`

## 2. 役職構成

- 村人（ダミー夜行動あり）
- 人狼（複数可）
- 占い師
- 霊媒師
- 騎士

10人例の基本構成：狼2/村5/占1/霊1/騎1  
人数に応じて **自動で役職構成を割り振る**

## 3. 夜フェーズの詳細仕様

### 3.1 人狼の重み付き投票

- Lv1（絶対排除）：3pt  
- Lv2（強めに怪しい）：2pt  
- Lv3（なんとなく）：1pt
- 全狼が投票完了するまで朝へ進行不可
- ホストUIの「朝へ進む」ボタンは Disabled
- **無襲撃不可**
- 同点はランダム選出

### 3.2 占い師

- 生存者1名を占う
- 結果は翌朝、本人にのみ通知

### 3.3 騎士

- 生存者1名を護衛
- 自分護衛不可
- 連続護衛不可（設定変更可能）

### 3.4 霊媒師

- 夜は操作なし
- 昨日の処刑者の役職を翌朝に通知

### 3.5 村人（メタ対策）

- 夜に「怪しいと思う人」を1人選ぶ（ゲーム結果に影響なし）

## 4. 昼フェーズ（議論）

- タイマー表示（3〜5分、変更可）
- ホストが手動で投票へ進む

## 5. 投票

- 生存者から1人を選択
- 公開/非公開は設定で切替
- 同数なら決選 → 一人に絞れるまで繰り返す
- 3回連続同数 → ホスト決定 or ランダム強制

## 6. 勝敗条件

- 人狼全滅 → 村勝利
- 人狼数 >= 村人数 → 人狼勝利

## 7. UI仕様（参加者）

- 夜：役職ごとの行動UI
- 朝：死亡発表、占い結果、霊媒結果
- 昼：議論タイマー
- 投票：通常→決選
- 結果：勝敗＋役職公開

## 8. UI仕様（ホスト）

- フェーズボタン（夜へ／朝へ／昼へ／投票へ／集計／決選）
- 夜：人狼投票の進捗
- 投票：得票状況・決選制御
- 結果：再戦・終了

## 9. データ保持

- プロファイル（台帳）は永続保存
- 出席簿（部屋）は台帳と紐付け
- 当日メンバーはスナップショット
- ゲーム参加者（役職配布時）もスナップショット
